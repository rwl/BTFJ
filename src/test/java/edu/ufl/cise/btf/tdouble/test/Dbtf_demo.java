/**
 * BTF, by Timothy A. Davis, Copyright (C) 2004-2011, University of Florida,
 * with support from Sandia National Laboratories.  All Rights Reserved.
 * Copyright (C) 2011 Richard Lincoln
 *
 * BTF is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This Module is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this Module; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 *
 */

package edu.ufl.cise.btf.tdouble.test;

import static edu.ufl.cise.btf.tdouble.Dbtf_order.btf_order;
import static edu.ufl.cise.btf.tdouble.Dbtf_strongcomp.btf_strongcomp;
import static edu.ufl.cise.btf.tdouble.Dbtf_maxtrans.btf_maxtrans;

import junit.framework.TestCase;

public class Dbtf_demo extends TestCase {

	int n;
	int [] Ai, Ap;

	public void test_btf() {
		int maxwork, nblocks ;
		int [] Q, P, R ;
		double [] work = new double[1] ;
		int [] nmatch = new int[1] ;

		/* get output arrays */
		P = new int [n] ;
		Q = new int [n] ;
		R = new int [n+1] ;

		maxwork = -1 ;
		work[0] = 0 ;

		/* find the permutation to BTF */
		nblocks = btf_order (n, Ap, Ai, maxwork, work, P, Q, R, nmatch) ;

		assertEquals(166, nblocks);
		assertEquals(2116.0, work[0]);
		assertEquals(479, nmatch[0]);
	}

	public void test_strongcomp() {

		int nblocks ;
		int [] Q, P, R ;

		/* get output arrays */
		P = new int [n] ;
		Q = new int [n] ;
		R = new int [n + 1] ;

		/* find the strongly-connected components of A */
		nblocks = btf_strongcomp (n, Ap, Ai, Q, P, R) ;

		assertEquals (477, nblocks) ;
	}

	public void test_maxtrans() {

		int maxwork, nmatch ;
		int [] Match ;
		double [] work = new double [1] ;

		/* get output array */
		Match = new int [n] ;

		maxwork = -1 ;
		work[0] = 0 ;

		/* perform the maximum transversal */
		nmatch = btf_maxtrans (n, n, Ap, Ai, maxwork, work, Match) ;

		assertEquals(2116.0, work[0]);
		assertEquals(479, nmatch);
	}

	protected void setUp() throws Exception {

		n = 479 ;

		Ap = new int[] {
		    0,    3,    6,    9,   11,   13,   18,   23,   26,   29,   32,
		   36,   39,   42,   45,   47,   49,   54,   57,   60,   63,   66,
		   69,   72,   75,   77,   79,   81,   83,   85,   87,   89,   91,
		   95,  101,  103,  105,  108,  112,  115,  118,  121,  124,  127,
		  129,  131,  136,  141,  144,  147,  150,  154,  157,  160,  163,
		  165,  167,  172,  175,  178,  181,  184,  187,  190,  192,  194,
		  196,  198,  200,  202,  204,  206,  208,  212,  218,  220,  222,
		  225,  229,  232,  235,  237,  238,  245,  247,  248,  255,  259,
		  294,  302,  304,  305,  319,  333,  347,  351,  380,  385,  387,
		  388,  399,  410,  421,  429,  438,  442,  445,  446,  458,  470,
		  482,  490,  506,  512,  515,  516,  527,  538,  549,  558,  567,
		  576,  585,  594,  603,  612,  621,  630,  639,  648,  657,  666,
		  675,  684,  693,  702,  711,  720,  729,  738,  747,  756,  765,
		  773,  781,  789,  797,  805,  813,  816,  819,  822,  825,  828,
		  831,  834,  837,  840,  843,  846,  849,  852,  855,  858,  861,
		  864,  867,  871,  875,  879,  886,  896,  898,  900,  907,  912,
		  918,  921,  923,  925,  927,  929,  931,  933,  935,  937,  939,
		  942,  945,  948,  951,  954,  957,  960,  963,  966,  969,  972,
		  975,  979,  983,  987,  992, 1000, 1002, 1004, 1010, 1013, 1017,
		 1018, 1020, 1022, 1024, 1026, 1028, 1030, 1032, 1034, 1036, 1044,
		 1047, 1050, 1053, 1054, 1060, 1066, 1072, 1080, 1086, 1087, 1090,
		 1091, 1097, 1103, 1109, 1117, 1120, 1123, 1126, 1127, 1133, 1139,
		 1145, 1147, 1149, 1151, 1158, 1164, 1165, 1168, 1169, 1175, 1181,
		 1187, 1195, 1198, 1201, 1204, 1205, 1211, 1217, 1223, 1225, 1227,
		 1229, 1237, 1243, 1244, 1247, 1248, 1254, 1260, 1266, 1274, 1277,
		 1280, 1283, 1284, 1290, 1296, 1302, 1304, 1306, 1308, 1316, 1322,
		 1323, 1326, 1327, 1333, 1339, 1345, 1353, 1356, 1359, 1362, 1363,
		 1369, 1375, 1381, 1383, 1385, 1387, 1395, 1401, 1402, 1405, 1406,
		 1412, 1418, 1424, 1432, 1435, 1438, 1441, 1442, 1448, 1454, 1460,
		 1462, 1464, 1466, 1474, 1480, 1481, 1484, 1485, 1491, 1497, 1503,
		 1505, 1507, 1509, 1511, 1513, 1515, 1517, 1519, 1521, 1523, 1525,
		 1527, 1529, 1531, 1533, 1535, 1537, 1539, 1541, 1543, 1545, 1547,
		 1549, 1551, 1553, 1555, 1557, 1559, 1561, 1563, 1565, 1567, 1569,
		 1571, 1573, 1575, 1578, 1582, 1586, 1588, 1590, 1592, 1594, 1596,
		 1598, 1603, 1608, 1613, 1615, 1617, 1619, 1621, 1623, 1625, 1628,
		 1631, 1634, 1636, 1638, 1643, 1648, 1651, 1654, 1657, 1661, 1664,
		 1667, 1670, 1672, 1674, 1679, 1681, 1683, 1685, 1688, 1692, 1696,
		 1698, 1700, 1702, 1704, 1706, 1708, 1713, 1718, 1723, 1725, 1727,
		 1729, 1731, 1733, 1735, 1738, 1741, 1744, 1746, 1748, 1753, 1758,
		 1761, 1764, 1767, 1771, 1774, 1777, 1780, 1782, 1784, 1789, 1792,
		 1795, 1798, 1801, 1804, 1807, 1809, 1811, 1813, 1815, 1817, 1819,
		 1821, 1823, 1825, 1829, 1835, 1837, 1839, 1842, 1846, 1849, 1852,
		 1854, 1856, 1858, 1860, 1862, 1864, 1866, 1868, 1870, 1872, 1874,
		 1876, 1878, 1880, 1882, 1884, 1886, 1888 } ;

		Ai = new int[] {
    		24, 30, 86, 25, 30, 87, 26, 30, 88, 27, 28, 28, 29, 29, 30, 86, 87,
    		88, 31, 42, 110, 111, 112, 32, 42, 110, 33, 42, 111, 34, 42, 112,
    		35, 36, 37, 38, 36, 42, 110, 37, 42, 111, 38, 42, 112, 39, 41, 40,
    		41, 41, 42, 110, 111, 112, 1, 7, 10, 2, 8, 11, 3, 9, 12, 4, 7, 10,
    		5, 8, 11, 6, 9, 12, 7, 16, 26, 8, 16, 9, 16, 10, 17, 11, 17, 12, 17,
    		13, 16, 14, 16, 15, 16, 16, 18, 29, 41, 17, 19, 22, 23, 29, 40, 18,
    		20, 19, 20, 20, 21, 29, 21, 23, 39, 40, 22, 29, 41, 23, 29, 41, 67,
    		73, 98, 68, 73, 99, 69, 73, 100, 70, 71, 71, 72, 72, 73, 98, 99,
    		100, 74, 85, 122, 123, 124, 75, 85, 122, 76, 85, 123, 77, 85, 124,
    		78, 79, 80, 81, 79, 85, 122, 80, 85, 123, 81, 85, 124, 82, 84, 83,
    		84, 84, 85, 122, 123, 124, 44, 50, 53, 45, 51, 54, 46, 52, 55, 47,
    		50, 53, 48, 51, 54, 49, 52, 55, 50, 59, 51, 59, 52, 59, 53, 60, 54,
    		60, 55, 60, 56, 59, 57, 59, 58, 59, 59, 61, 72, 84, 60, 62, 65, 66,
    		72, 83, 61, 63, 62, 63, 63, 64, 72, 64, 66, 82, 83, 65, 72, 84, 66,
    		72, 84, 30, 243, 42, 0, 16, 17, 30, 34, 42, 242, 73, 387, 85, 43,
    		59, 60, 73, 77, 85, 386, 384, 385, 386, 387, 95, 96, 97, 119, 120,
    		121, 140, 141, 142, 184, 185, 186, 388, 437, 438, 439, 440, 441, 442,
    		449, 450, 451, 454, 455, 457, 458, 460, 461, 462, 463, 471, 472, 473,
    		474, 475, 181, 182, 183, 390, 454, 455, 457, 467, 387, 466, 478, 202,
    		203, 204, 208, 209, 210, 381, 384, 436, 452, 453, 466, 468, 478, 202,
    		203, 204, 208, 209, 210, 382, 385, 436, 452, 453, 466, 469, 478, 202,
    		203, 204, 208, 209, 210, 383, 386, 436, 452, 453, 466, 470, 478, 240,
    		241, 242, 243, 107, 108, 109, 131, 132, 133, 244, 394, 395, 396, 397,
    		398, 399, 406, 407, 408, 411, 412, 414, 415, 417, 418, 419, 420, 428,
    		429, 430, 431, 432, 245, 411, 412, 414, 424, 243, 423, 435, 159, 160,
    		161, 237, 240, 393, 409, 410, 423, 425, 435, 159, 160, 161, 238, 241,
    		393, 409, 410, 423, 426, 435, 159, 160, 161, 239, 242, 393, 409, 410,
    		423, 427, 435, 240, 241, 242, 243, 252, 253, 254, 255, 134, 135, 136,
    		150, 151, 152, 244, 247, 248, 147, 148, 149, 246, 243, 247, 255, 248,
    		146, 168, 169, 170, 174, 175, 176, 237, 240, 247, 248, 252, 146, 168,
    		169, 170, 174, 175, 176, 238, 241, 247, 248, 253, 146, 168, 169, 170,
    		174, 175, 176, 239, 242, 247, 248, 254, 362, 363, 364, 365, 384, 385,
    		386, 387, 214, 215, 216, 217, 218, 219, 226, 227, 228, 231, 232, 234,
    		235, 388, 391, 392, 231, 232, 234, 367, 368, 389, 365, 387, 391, 392,
    		180, 193, 194, 195, 229, 230, 362, 381, 384, 391, 392, 180, 193, 194,
    		195, 229, 230, 363, 382, 385, 391, 392, 180, 193, 194, 195, 229, 230,
    		364, 383, 386, 391, 392, 92, 95, 247, 261, 283, 305, 327, 349, 371,
    		93, 96, 247, 261, 283, 305, 327, 349, 371, 94, 97, 247, 261, 283, 305,
    		327, 349, 371, 92, 95, 247, 261, 283, 305, 327, 349, 371, 93, 96, 247,
    		261, 283, 305, 327, 349, 371, 94, 97, 247, 261, 283, 305, 327, 349,
    		371, 104, 107, 263, 285, 307, 329, 351, 373, 391, 105, 108, 263, 285,
    		307, 329, 351, 373, 391, 106, 109, 263, 285, 307, 329, 351, 373, 391,
    		104, 107, 263, 285, 307, 329, 351, 373, 391, 105, 108, 263, 285, 307,
    		329, 351, 373, 391, 106, 109, 263, 285, 307, 329, 351, 373, 391, 116,
    		119, 248, 262, 284, 306, 328, 350, 372, 117, 120, 248, 262, 284, 306,
    		328, 350, 372, 118, 121, 248, 262, 284, 306, 328, 350, 372, 116, 119,
    		248, 262, 284, 306, 328, 350, 372, 117, 120, 248, 262, 284, 306, 328,
    		350, 372, 118, 121, 248, 262, 284, 306, 328, 350, 372, 128, 131, 264,
    		286, 308, 330, 352, 374, 392, 129, 132, 264, 286, 308, 330, 352, 374,
    		392, 130, 133, 264, 286, 308, 330, 352, 374, 392, 128, 131, 264, 286,
    		308, 330, 352, 374, 392, 129, 132, 264, 286, 308, 330, 352, 374, 392,
    		130, 133, 264, 286, 308, 330, 352, 374, 392, 134, 140, 265, 287, 309,
    		331, 353, 375, 135, 141, 266, 288, 310, 332, 354, 376, 136, 142, 267,
    		289, 311, 333, 355, 377, 134, 140, 265, 287, 309, 331, 353, 375, 135,
    		141, 266, 288, 310, 332, 354, 376, 136, 142, 267, 289, 311, 333, 355,
    		377, 137, 147, 237, 138, 148, 238, 139, 149, 239, 143, 181, 381, 144,
    		182, 382, 145, 183, 383, 394, 400, 403, 395, 401, 404, 396, 402, 405,
    		397, 400, 403, 398, 401, 404, 399, 402, 405, 159, 400, 409, 160, 401,
    		409, 161, 402, 409, 162, 403, 410, 163, 404, 410, 164, 405, 410, 159,
    		160, 406, 409, 159, 161, 407, 409, 160, 161, 408, 409, 162, 163, 164,
    		409, 411, 422, 434, 156, 162, 163, 164, 410, 412, 415, 416, 422, 433,
    		411, 413, 412, 413, 157, 162, 163, 164, 413, 414, 422, 156, 414, 416,
    		432, 433, 162, 163, 164, 415, 422, 434, 416, 422, 434, 147, 177, 148,
    		178, 149, 179, 147, 165, 148, 166, 149, 167, 147, 153, 148, 154, 149,
    		155, 214, 220, 223, 215, 221, 224, 216, 222, 225, 217, 220, 223, 218,
    		221, 224, 219, 222, 225, 193, 220, 229, 194, 221, 229, 195, 222, 229,
    		196, 223, 230, 197, 224, 230, 198, 225, 230, 193, 194, 226, 229, 193,
    		195, 227, 229, 194, 195, 228, 229, 196, 197, 198, 229, 231, 190, 196,
    		197, 198, 230, 232, 235, 236, 231, 233, 232, 233, 191, 196, 197, 198,
    		233, 234, 190, 234, 236, 196, 197, 198, 235, 236, 181, 211, 182, 212,
    		183, 213, 181, 199, 182, 200, 183, 201, 181, 187, 182, 188, 183, 189,
    		240, 241, 242, 243, 252, 253, 254, 255, 256, 263, 264, 245, 246, 257,
    		243, 255, 263, 264, 240, 249, 252, 260, 263, 264, 241, 250, 253, 260,
    		263, 264, 242, 251, 254, 260, 263, 264, 252, 253, 254, 255, 274, 275,
    		276, 277, 256, 261, 262, 265, 266, 267, 258, 255, 261, 277, 262, 249,
    		252, 259, 261, 262, 274, 250, 253, 259, 261, 262, 275, 251, 254, 259,
    		261, 262, 276, 252, 253, 254, 255, 274, 275, 276, 277, 278, 285, 286,
    		257, 258, 279, 255, 277, 285, 286, 252, 271, 274, 282, 285, 286, 253,
    		272, 275, 282, 285, 286, 254, 273, 276, 282, 285, 286, 249, 268, 250,
    		269, 251, 270, 274, 275, 277, 296, 297, 298, 299, 278, 283, 284, 287,
    		288, 289, 280, 277, 283, 299, 284, 271, 274, 281, 283, 284, 296, 272,
    		275, 281, 283, 284, 297, 273, 276, 281, 283, 284, 298, 274, 275, 276,
    		277, 296, 297, 298, 299, 300, 307, 308, 279, 280, 301, 277, 299, 307,
    		308, 274, 293, 296, 304, 307, 308, 275, 294, 297, 304, 307, 308, 276,
    		295, 298, 304, 307, 308, 271, 290, 272, 291, 273, 292, 296, 297, 298,
    		299, 318, 319, 320, 321, 300, 305, 306, 309, 310, 311, 302, 299, 305,
    		321, 306, 293, 296, 303, 305, 306, 318, 294, 297, 303, 305, 306, 319,
    		295, 298, 303, 305, 306, 320, 296, 297, 298, 299, 318, 319, 320, 321,
    		322, 329, 330, 301, 302, 323, 299, 321, 329, 330, 296, 315, 318, 326,
    		329, 330, 297, 316, 319, 326, 329, 330, 298, 317, 320, 326, 329, 330,
    		293, 312, 294, 313, 295, 314, 318, 319, 320, 321, 340, 341, 342, 343,
    		322, 327, 328, 331, 332, 333, 324, 321, 327, 343, 328, 315, 318, 325,
    		327, 328, 340, 316, 319, 325, 327, 328, 341, 317, 320, 325, 327, 328,
    		342, 318, 319, 320, 321, 340, 341, 342, 343, 344, 351, 352, 323, 324,
    		345, 321, 343, 351, 352, 318, 337, 340, 348, 351, 352, 319, 338, 341,
    		348, 351, 352, 320, 339, 342, 348, 351, 352, 315, 334, 316, 335, 317,
    		336, 340, 341, 342, 343, 362, 363, 364, 365, 344, 349, 350, 353, 354,
    		355, 346, 343, 349, 365, 350, 337, 340, 347, 349, 350, 362, 338, 341,
    		347, 349, 350, 363, 339, 342, 347, 349, 350, 364, 340, 341, 342, 343,
    		362, 363, 364, 365, 366, 373, 374, 345, 346, 367, 343, 365, 373, 374,
    		340, 359, 362, 370, 373, 374, 341, 360, 363, 370, 373, 374, 342, 361,
    		364, 370, 373, 374, 337, 356, 338, 357, 339, 358, 362, 363, 364, 365,
    		384, 385, 386, 387, 366, 371, 372, 375, 376, 377, 368, 365, 371, 387,
    		372, 359, 362, 369, 371, 372, 384, 360, 363, 369, 371, 372, 385, 361,
    		364, 369, 371, 372, 386, 359, 378, 360, 379, 361, 380, 86, 92, 87, 93,
    		88, 94, 89, 95, 90, 96, 91, 97, 98, 104, 99, 105, 100, 106, 101, 107,
    		102, 108, 103, 109, 110, 116, 111, 117, 112, 118, 113, 119, 114, 120,
    		115, 121, 122, 128, 123, 129, 124, 130, 125, 131, 126, 132, 127, 133,
    		134, 137, 135, 138, 136, 139, 140, 143, 141, 144, 142, 145, 150, 153,
    		151, 154, 152, 155, 156, 157, 158, 157, 162, 163, 164, 158, 162, 163,
    		164, 159, 162, 160, 163, 161, 164, 162, 165, 163, 166, 164, 167, 168,
    		171, 174, 175, 176, 169, 172, 174, 175, 176, 170, 173, 174, 175, 176,
    		171, 174, 172, 175, 173, 176, 174, 177, 175, 178, 176, 179, 101, 417,
    		423, 102, 418, 423, 103, 419, 423, 420, 421, 421, 422, 101, 102, 103,
    		422, 423, 125, 126, 127, 424, 435, 125, 425, 435, 126, 426, 435, 127,
    		427, 435, 428, 429, 430, 431, 125, 429, 435, 126, 430, 435, 127, 431,
    		435, 432, 434, 433, 434, 125, 126, 127, 434, 435, 184, 187, 185, 188,
    		186, 189, 190, 191, 192, 191, 196, 197, 198, 192, 196, 197, 198, 193,
    		196, 194, 197, 195, 198, 196, 199, 197, 200, 198, 201, 202, 205, 208,
    		209, 210, 203, 206, 208, 209, 210, 204, 207, 208, 209, 210, 205, 208,
    		206, 209, 207, 210, 208, 211, 209, 212, 210, 213, 89, 460, 466, 90,
    		461, 466, 91, 462, 466, 463, 464, 464, 465, 89, 90, 91, 465, 466, 113,
    		114, 115, 467, 478, 113, 468, 478, 114, 469, 478, 115, 470, 478, 471,
    		472, 473, 474, 113, 472, 478, 114, 473, 478, 115, 474, 478, 475, 477,
    		476, 477, 113, 114, 115, 477, 478, 437, 443, 446, 438, 444, 447, 439,
    		445, 448, 440, 443, 446, 441, 444, 447, 442, 445, 448, 443, 452, 444,
    		452, 445, 452, 446, 453, 447, 453, 448, 453, 449, 452, 450, 452, 451,
    		452, 452, 454, 465, 477, 453, 455, 458, 459, 465, 476, 454, 456, 455,
    		456, 456, 457, 465, 457, 459, 475, 476, 458, 465, 477, 459, 465, 477,
    		265, 268, 266, 269, 267, 270, 287, 290, 288, 291, 289, 292, 309, 312,
    		310, 313, 311, 314, 331, 334, 332, 335, 333, 336, 353, 356, 354, 357,
    		355, 358, 375, 378, 376, 379, 377, 380 } ;

		super.setUp();
	}

}
